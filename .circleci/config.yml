version: 2
jobs:
  build:
    docker:
      - image: mcr.microsoft.com/dotnet/sdk:7.0
    environment:
      - DOTNET_CLI_TELEMETRY_OPTOUT: 1
    steps:
      - run:
          name: Install unzip
          command: |
            apt-get update
            apt-get install -y unzip
      - run:
          name: Install OpenSSH and Git
          command: apt-get update && apt-get install -y openssh-client git
      - run:
          name: Install .NET
          command: apt-get install dotnet-sdk-2.0
      - checkout
      - run: ./build.sh --target=restore
      - run: ./build.sh --target=generate
      - run: ./build.sh --target=build
      - run: ./build.sh --target=test
